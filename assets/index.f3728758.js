import{r as e,o as t,c as i,a,w as o,p as n,b as l,d as s,e as r,_ as c,F as d,f as g,g as h,v as m,t as u,h as f,i as p,j as x,k as v,l as w,H as C}from"./vendor.7a751af2.js";var I=document.createElement("canvas"),T=I.getContext("2d");var y=function(){var e={isBusy:!1,txtCount:0};return e.ocrImage=function(t){var i,a;i=t.width,a=t.height,I.width=i,I.height=a,T.drawImage(t,0,0);var o=T.getImageData(0,0,t.width,t.height);let n=new ArrayBuffer(o.data.length);var l=new Uint8Array(n);for(let e=0;e<l.length;e++)l[e]=o.data[e];k.postMessage([t.width,t.height,n],[n]),k.onmessage=function(i){var a=JSON.parse(i.data);a.imgWidth=t.width,a.imgHeight=t.height,e.isBusy=!1,e.onRecognitionCompleted&&e.onRecognitionCompleted(a)}},e.ocrImageUrl=function(t,i){var a=new Image;e.isBusy?e.onError&&e.onError("antocr is busy"):(e.isBusy=!0,a.userData=i,a.onload=function(){e.onImageLoad&&e.onImageLoad(this,this.userData),e.ocrImage(this)},a.src=t)},e}(),k=new function(){return new Worker("/assets/AntOcrWorker.7dd3b600.js",{type:"module"})};k.onmessage=function(e){console.log("Received message "+e.data),y.onRuntimeInitialized&&y.onRuntimeInitialized(),y.init=!0};const b={props:["tips","iconClass","selected"],emits:["click"]},S=o("data-v-a01c7a88"),D=S(((o,n,l,s,r,c)=>{const d=e("el-tooltip");return t(),i(d,{class:[{"icon-button_selected":l.selected,"icon-button_unselected":!l.selected},"tipsitem icon-button"],effect:"dark",content:l.tips,"show-after":500,placement:"bottom"},{default:S((()=>[a("i",{class:l.iconClass,onClick:n[1]||(n[1]=e=>{o.$emit("click")})},null,2)])),_:1},8,["class","content"])}));b.render=D,b.__scopeId="data-v-a01c7a88";var _={};function L(e,t,i){"object"==typeof e?e[t]=i:"function"==typeof e&&e(i)}_._data={},_._changeCallBack={},_.reset=()=>{_._data={highlightErrWord:!1,highlightErrWordThres:.6,recThres:.6,unclipRadio:1.6,keepLowScore:!1},_.save()},_.save=()=>{let e=JSON.stringify(_._data);localStorage.setItem("PearOcrConfig",e)},_.load=()=>{let e=localStorage.getItem("PearOcrConfig");e?_._data=JSON.parse(e):_.reset()},_.get=e=>_._data[e],_.set=(e,t)=>{if(_._changeCallBack[e]&&_._data[e]!=t)for(const i of _._changeCallBack[e])L(i,e,t);_._data[e]=t},_.setFromDict=e=>{for(const t in e)_.set(t,e[t])},_.getToDict=e=>{for(const t in e){let i=_.get(t);null!=i&&(e[t]=i)}},_.addMonitor=(e,t)=>{if("object"!=typeof e)null==_._changeCallBack[e]&&(_._changeCallBack[e]=[]),_._changeCallBack[e].push(t),_._data[e]&&L(t,e,_._data[e]);else for(const i of e)_.addMonitor(i,t)},_.load();const B={data:()=>({configure:{highlightErrWord:!1,highlightErrWordThres:.6,recThres:.6,unclipRadio:1.6,keepLowScore:!1}}),created(){console.log(this.configure),_.getToDict(this.configure)},props:["dialogVisible"],emits:["update:dialogVisible"],methods:{handleClose(e){e&&e()},savaConfigure(){_.setFromDict(this.configure),_.save()},resetConfigure(){_.reset(),_.getToDict(this.configure)}},watch:{dialogVisible(e){e&&_.getToDict(this.configure)}}},E=o("data-v-4317aaaa");n("data-v-4317aaaa");const P=a("label",null,"判断阈值",-1),V=a("label",null,"保留高亮显示",-1),R={class:"dialog-footer"},H=r(" 恢复默认 "),W=r("取 消"),M=r("保存设置");l();const $=E(((o,n,l,r,c,d)=>{const g=e("el-switch"),h=e("el-input-number"),m=e("el-form-item"),u=e("el-form"),f=e("el-button"),p=e("el-dialog");return t(),i(p,{title:"PearOCR配置","model-value":l.dialogVisible,"onUpdate:modelValue":n[8]||(n[8]=e=>{l.dialogVisible=e,o.$emit("update:dialogVisible",l.dialogVisible)}),"before-close":d.handleClose,"destroy-on-close":!0,width:"500px"},{footer:E((()=>[a("span",R,[a(f,{type:"warning",onClick:d.resetConfigure,size:"small"},{default:E((()=>[H])),_:1},8,["onClick"]),a(f,{onClick:n[6]||(n[6]=e=>{l.dialogVisible=!1,d.handleClose()}),size:"small"},{default:E((()=>[W])),_:1}),a(f,{type:"primary",onClick:n[7]||(n[7]=e=>{d.savaConfigure(),l.dialogVisible=!1}),size:"small"},{default:E((()=>[M])),_:1})])])),default:E((()=>[a(u,{ref:"Configure",model:c.configure,"label-width":"auto"},{default:E((()=>[a(m,{label:"高亮疑似错误"},{default:E((()=>[a(g,{modelValue:c.configure.highlightErrWord,"onUpdate:modelValue":n[1]||(n[1]=e=>c.configure.highlightErrWord=e)},null,8,["modelValue"]),P,a(h,{modelValue:c.configure.highlightErrWordThres,"onUpdate:modelValue":n[2]||(n[2]=e=>c.configure.highlightErrWordThres=e),size:"mini",precision:2,step:.1,min:0,max:1},null,8,["modelValue","step"])])),_:1}),a(m,{label:"置信度阈值"},{default:E((()=>[a(h,{modelValue:c.configure.recThres,"onUpdate:modelValue":n[3]||(n[3]=e=>c.configure.recThres=e),size:"mini",precision:2,step:.1,min:0,max:1},null,8,["modelValue","step"]),V,a(g,{modelValue:c.configure.keepLowScore,"onUpdate:modelValue":n[4]||(n[4]=e=>c.configure.keepLowScore=e)},null,8,["modelValue"])])),_:1}),s("",!0)])),_:1},8,["model"])])),_:1},8,["model-value","before-close"])}));B.render=$,B.__scopeId="data-v-4317aaaa";var O={callBackDict:{},keyValDict:{},addevent:(e,t)=>{O.callBackDict[e]||(O.callBackDict[e]=[]),O.callBackDict[e].push(t),null!=O.keyValDict[e]&&t(O.keyValDict[e])},set:(e,t)=>{if(O.keyValDict[e]=t,O.callBackDict[e])for(const i of O.callBackDict[e])i(t)},get:e=>O.keyValDict[e]},U=null,z=0,A=!1;y.onRuntimeInitialized=function(){console.log("onRuntimeInitialized"),U&&U.$emit("onRuntimeInitialized"),A=!0,O.set("AntOcrInited",!0)};const F={components:{IconButton:b,Configure:B},data:()=>({onRecognitionError:null,imageList:new Array,selectedId:-1,scannedCount:0,configureVisible:!1}),created:function(){U=this,A&&U.$emit("onRuntimeInitialized")},emits:["onRuntimeInitialized","currentItemChange","clearRecognitionImage"],mounted(){document.addEventListener("paste",this.fromClipboard)},methods:{uploadClick(){this.$refs.inputFile.dispatchEvent(new MouseEvent("click"))},idleCheck:(e=!1)=>!y.isBusy||(e||c({showClose:!0,message:"已有识别任务正在进行，请等待识别完成再操作",type:"error"}),!1),findIndexById(e){for(let t=0;t<this.imageList.length;t++)if(e==this.imageList[t].id)return t;return-1},recognitionImage(e){let t;if(e)t=U.findIndexById(e);else if(e=U.selectedId,t=U.findIndexById(e),null!=U.imageList[t].text){for(t=U.imageList.length-1;t>=0;t--)if(null==U.imageList[t].text){e=U.imageList[t].id;break}if(t<0)return}null==U.imageList[t].text&&(y.onRecognitionCompleted=i=>{if(console.log("onRecognitionCompleted",e),t=U.findIndexById(e),!(t<0)){var a="";for(let e=0;e<i.length;e++)a=a+i[e].text+"\n";U.imageList[t].isScaning=!1,U.scannedCount++,U.imageList[t].text=a,U.imageList[t].detail=i,U.recognitionImage(),console.log("recognitionImage next")}},y.onImageLoad=(e,i)=>{t=U.findIndexById(i),U.imageList[t].imgWidth=e.width,U.imageList[t].imgHeight=e.height},U.imageList[t].isScaning=!0,y.ocrImageUrl(U.imageList[t].url,e),console.log("ocrImageUrl",e))},addImageToList(e,t){var i={};i.url=e,i.selected=!1,i.id=z,i.filename=t,z+=1,U.imageList.unshift(i),U.idleCheck(!0)&&U.imageClick(i.id),U.$nextTick(U.$refs.imgListScrollbar.update)},addImgPreview(e){e||(e=this.$refs.inputFile.files);for(const t of e){if(!t)return void console.log("error");{if("image"!=t.type.substring(0,5))return void c({showClose:!0,message:"读取失败：错误的文件类型",type:"error"});const e=new FileReader;e.readAsDataURL(t),e.filename=t.name,e.onload=function(t){U.addImageToList(this.result,e.filename)}}}},imageClick(e){if(this.selectedId==e)return;this.selectedId=e;let t=this.findIndexById(e);y.isBusy||null!=this.imageList[t].text||this.recognitionImage(e),this.$emit("currentItemChange",this.imageList[t])},deleteClick(e){let t=this.findIndexById(e);this.imageList[t].isScaning||(null!=this.imageList[t].isScaning&&U.scannedCount--,this.imageList.splice(t,1),0==t&&(this.$refs.inputFile.value=""),t>=this.imageList.length&&(t-=1),t>=0?U.imageClick(this.imageList[t].id):U.$emit("clearRecognitionImage"))},DeleteAllImage(){0!=this.imageList.length&&this.$confirm("此操作删除所有图像和识别结果, 是否继续?","删除确认",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then((()=>{let e=[];for(;this.imageList.length>0;){let t=this.imageList.splice(0,1);t[0].isScaning&&e.push(t[0])}console.log("scaningItem",e),e.length?(this.imageList=e,U.imageClick(this.imageList[0].id)):(U.$emit("clearRecognitionImage"),this.selectedId=-1),this.scannedCount=0,this.$message({type:"success",message:e.length?"不能删除正在识别的图像，请等待识别完成再删除":"删除成功!"})})).catch((()=>{this.$message({type:"info",message:"已取消删除"})}))},fromClipboard(e){navigator.clipboard.read().then((e=>{console.log("Pasted content: ",e);var t=!1;for(let a=0;a<e.length;a++)for(var i of e[a].types)-1!==i.indexOf("image")&&(t=!0,e[a].getType(i).then((e=>{var t=URL.createObjectURL(e);U.addImageToList(t)})));t||c({showClose:!0,message:"没有检测到剪贴板内的图像",type:"warning"})})).catch((e=>{c({showClose:!0,message:"读取剪贴板失败，请确认是否开放剪贴权限或剪贴板没有图像数据。",type:"error"})}))}}},G=o("data-v-e498ccea");n("data-v-e498ccea");const N={class:"rowCard"},j=a("i",{class:"iconfont icon-located"},null,-1),J=r(" 本地图片 "),q=a("i",{class:"iconfont icon-clipboard"},null,-1),K=r(" 读剪贴板 "),Q={class:"flex-content"},X={class:"delete"},Y={class:"ctrlbar"};l();const Z=G(((o,n,l,s,r,c)=>{const f=e("el-col"),p=e("el-image"),x=e("el-scrollbar"),v=e("el-row"),w=e("IconButton"),C=e("Configure");return t(),i(d,null,[a("div",N,[a(v,{type:"flex"},{default:G((()=>[a(f,{class:"col_ctrlarea"},{default:G((()=>[a("div",null,[a("input",{ref:"inputFile",type:"file",style:{display:"none"},onChange:n[1]||(n[1]=e=>c.addImgPreview()),accept:"image/*",multiple:""},null,544)]),a("div",{class:"ao_button",onClick:n[2]||(n[2]=e=>c.uploadClick())},[j,J]),a("div",{class:"ao_button",onClick:n[3]||(n[3]=e=>c.fromClipboard(e))},[q,K])])),_:1}),a(f,{class:"col_imagelist"},{default:G((()=>[a(x,{ref:"imgListScrollbar"},{default:G((()=>[a("div",Q,[(t(!0),i(d,null,g(r.imageList,(e=>(t(),i("div",{key:e.id},[a("div",X,[a(p,{class:["item",{item_prepare:null!=e.text&&r.selectedId!=e.id,item_unselected:null==e.text&&r.selectedId!=e.id,item_selected:r.selectedId==e.id,scanBox:e.isScaning}],src:e.url,onClick:t=>c.imageClick(e.id),fit:"contain"},null,8,["src","class","onClick"]),h(a("i",{onClick:t=>c.deleteClick(e.id),class:"el-icon-delete delete-button"},null,8,["onClick"]),[[m,!e.isScaning]])])])))),128))])])),_:1},512)])),_:1})])),_:1}),a("div",Y,[a("span",null," 识别进度:"+u(r.scannedCount)+"/"+u(r.imageList.length),1),a(w,{tips:"删除所有图片",iconClass:"el-icon-delete",onClick:n[4]||(n[4]=e=>c.DeleteAllImage())}),a(w,{tips:"设置",iconClass:"el-icon-setting",onClick:n[5]||(n[5]=e=>r.configureVisible=!0)})])]),a(C,{dialogVisible:r.configureVisible,"onUpdate:dialogVisible":n[6]||(n[6]=e=>r.configureVisible=e)},null,8,["dialogVisible"])],64)}));let ee;F.render=Z,F.__scopeId="data-v-e498ccea";const te={};function ie(e,t){return Math.sqrt((e.x-t.x)*(e.x-t.x)+(e.y-t.y)*(e.y-t.y))}function ae(e){e.colorText="";for(let t=0;t<e.wordScore.length;t++){e.wordScore[t]<oe.highlightErrWordThres?e.colorText+="<font color=red>"+e.text[t]+"</font>":e.colorText+=e.text[t]}}let oe;const ne={data:()=>({dCSS:"",ctWidth:0,ctHeight:0,dCSS_image:"",highlightErrWord:!1,recThres:.6,keepLowScore:!1,highlightErrWordThres:.6}),props:["recoItem","fullScreen","imageBG","contenteditable"],emits:["onExitFullScreen"],methods:{textChange(e,t){e.target.innerText!=t.text?t.textEdited=e.target.innerText:t.textEdited="",this.$forceUpdate()},getDisplayText(e){return e.textEdited?e.textEdited:this.highlightErrWord&&e.colorText?e.colorText:e.text},updata(e){if(this.$refs.PosTextBox){if(this.fullScreen)this.ctHeight=window.innerHeight,this.ctWidth=window.innerWidth;else{var t=this.$refs.PosTextBox.parentNode;this.ctHeight=t.offsetHeight,this.ctWidth=t.offsetWidth}var i=window.devicePixelRatio,a=1/i,o=e.detail.imgWidth,n=e.detail.imgHeight;this.dCSS="width: "+o.toString()+"px;height: "+n.toString()+"px;";var l=this.ctWidth*a/o,s=this.ctHeight*a/n,r=Math.min(l,s)*i,c=-n*(1-(r=Math.min(1,r)))/2,d=-o*(1-r)/2;c+=(this.ctHeight-n*r)/2,d+=(this.ctWidth-o*r)/2,this.dCSS+="transform: scale("+r.toString()+");",this.dCSS+="top: "+c.toString()+"px;",this.fullScreen?(this.dCSS+="z-index: 21;position: fixed;",this.dCSS_image=this.dCSS):this.dCSS_image="",this.dCSS+="left: "+d.toString()+"px;",function(e){for(let l=0;l<e.detail.length;l++){var t=e.detail[l];e.detail[l].textCss="transform: matrix("+t.trMat[0].toString()+", "+t.trMat[1].toString()+", "+t.trMat[2].toString()+", "+t.trMat[3].toString()+", "+t.trMat[4].toString()+", "+t.trMat[5].toString()+");";var i=ie(e.detail[l].rect[0],e.detail[l].rect[1]),a=ie(e.detail[l].rect[1],e.detail[l].rect[2]),o=Math.min(i,a),n=Math.max(i,a);e.detail[l].textCss+="width: "+n.toString()+"px;height: "+o.toString()+"px;",e.detail[l].textCss+="font-size: "+o.toString()+"px;",ae(e.detail[l])}}(e),this.$nextTick((()=>{!function(e,t){for(var i,a=e.childNodes,o=a.length-1;o>=0;o--){var n=a[o].childNodes[0];if(n&&n.getAttribute&&!n.getAttribute("isHandleTextSize")){var l=n.childNodes[0];if(l){var s=a[o].getBoundingClientRect(),r=l.getBoundingClientRect();if(s.width>r.width+5){var c=(i=l,"string"==typeof i.innerText?i.innerText:i.textContent).length,d=(s.width-r.width)/t/(c-1);l.style.letterSpacing=d.toString()+"px"}else if(s.width<r.width){var g=s.width/r.width;if(g>.98)continue;n.style.cssText="transform: scale("+g.toString()+");"}n.setAttribute("isHandleTextSize",!0)}}}}(this.$refs.PosTextBox,r)}))}}},created(){oe=this,_.addMonitor(["highlightErrWord","highlightErrWordThres","recThres","keepLowScore"],oe)},mounted:function(){this.updata(this.recoItem)},beforeUpdate(){this.updata(this.recoItem)},watch:{recoItem(e,t){this.updata(e)}}},le=o("data-v-73d60dfa");n("data-v-73d60dfa");const se={key:0,class:"covered"},re={class:"PosTextBoxDiv"},ce={class:"PosTextBoxDiv2"},de={class:"tramsformOriLT"};l();const ge=le(((o,n,l,r,c,u)=>{const f=e("el-image");return t(),i(d,null,[l.fullScreen?(t(),i("div",se)):s("",!0),l.fullScreen?(t(),i("i",{key:1,onClick:n[1]||(n[1]=e=>o.$emit("onExitFullScreen")),class:"el-icon-close close-button"})):s("",!0),l.imageBG?(t(),i(f,{key:2,class:"boxTextImageBG",style:c.dCSS_image,src:l.recoItem.url,fit:"scale-down"},null,8,["style","src"])):s("",!0),a("div",re,[a("div",ce,[a("div",{class:"PosTextBox",style:c.dCSS,ref:"PosTextBox"},[(t(!0),i(d,null,g(l.recoItem.detail,(e=>h((t(),i("div",{class:"rotateBox",contenteditable:l.contenteditable,onBlur:t=>u.textChange(t,e),key:e.rect,style:e.textCss},[a("div",de,[a("span",{class:{errorTextColor:e.score<c.recThres&&!e.textEdited,editedTextColor:e.textEdited},innerHTML:u.getDisplayText(e)},null,10,["innerHTML"])])],44,["contenteditable","onBlur"])),[[m,e.score>=c.recThres||c.keepLowScore]]))),128))],4)])])],64)}));ne.render=ge,ne.__scopeId="data-v-73d60dfa";var he=null;const me={components:{IconButton:b,RotateText:ne,ExportPDF:f((()=>function(e,t){if(!t||0===t.length)return e();if(void 0===ee){const e=document.createElement("link").relList;ee=e&&e.supports&&e.supports("modulepreload")?"modulepreload":"preload"}return Promise.all(t.map((e=>{if(e in te)return;te[e]=!0;const t=e.endsWith(".css"),i=t?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${i}`))return;const a=document.createElement("link");return a.rel=t?"stylesheet":ee,t||(a.as="script",a.crossOrigin=""),a.href=e,document.head.appendChild(a),t?new Promise(((e,t)=>{a.addEventListener("load",e),a.addEventListener("error",t)})):void 0}))).then((()=>e()))}((()=>import("./ExportPDF.2b00ae36.js")),["/assets/ExportPDF.2b00ae36.js","/assets/ExportPDF.acdcca7f.css","/assets/vendor.7a751af2.js"])))},data:()=>({showType:"PosText",tableH:348,textEdited:"",showViewer:!1,imageBG:!1,saveToPdfVisible:!1,AntOcrInited:!1,PosTextEditable:!1,recThres:.6,keepLowScore:!1}),props:["recoData","loading"],created:function(){he=this,_.addMonitor(["recThres","keepLowScore"],he)},beforeUpdate(){he.recoData.textEdited||(he.recoData.textEdited=he.recoData.text)},mounted(){O.addevent("AntOcrInited",(e=>{he.AntOcrInited=!0}))},watch:{recoData:{deep:!0,handler(){}}},methods:{getRowClass:({row:e,rowIndex:t})=>he.recThres>e.score?he.keepLowScore?"error-row":"error-row-hidden":"",openPdfDialog(){O.get("ExportPDFInited")?he.saveToPdfVisible=!0:c({showClose:!0,message:"PDF模块尚未加载完成，请等待完成后再试",type:"warning"})},getPlaceholderText:()=>he.recoData.url?null==he.recoData.text?"等待识别":""==he.recoData.text?"未识别到文本":void 0:"识别结果在此处显示",isScaning:()=>he.recoData.isScaning,showPoxtextViewer(){this.prevOverflow=document.body.style.overflow,document.body.style.overflow="hidden",this.showViewer=!0},closePoxtextViewer(){document.body.style.overflow=this.prevOverflow,this.showViewer=!1},setShowType(e){he.showType=e},onTextCopy(){he.recoData.textEdited&&""!=he.recoData.textEdited&&navigator.clipboard.writeText(he.recoData.textEdited).then((()=>{c({showClose:!0,duration:1e3,message:"复制成功",type:"success"})})).catch((()=>{c({showClose:!0,message:"复制失败，请确认是否开放剪贴板权限。",type:"error"})}))}}},ue=o("data-v-1df7ae6a");n("data-v-1df7ae6a");const fe={key:0,class:"recText placeholder"},pe={style:{"text-align":"left"}},xe={key:2,style:{"overflow-x":"hidden","overflow-y":"hidden",position:"relative"},class:"recText recTextTable"},ve={class:"ShowTypeDiv"},we={key:2,class:"ButtonGroud"};l();const Ce=ue(((o,n,l,r,c,g)=>{const f=e("el-skeleton"),p=e("el-input"),x=e("RotateText"),v=e("el-table-column"),w=e("el-table"),C=e("IconButton"),I=e("ExportPDF");return t(),i(d,null,[h(a(f,{class:"boxTextImageLoading",rows:6,animated:""},null,512),[[m,g.isScaning()]]),h(a("div",{class:["boxTextImage",{recTextEdited:"Text"==c.showType&&l.recoData.textEdited!=l.recoData.text}]},[l.recoData.text?s("",!0):(t(),i("div",fe,[a("div",pe,[a("p",null,u(g.getPlaceholderText()),1)])])),"PureText"==c.showType&&l.recoData.text?(t(),i(p,{key:1,ref:"recoTextarea",class:"recText",type:"textarea",rows:22,placeholder:"识别结果在此显示",resize:"none",modelValue:l.recoData.textEdited,"onUpdate:modelValue":n[1]||(n[1]=e=>l.recoData.textEdited=e)},null,8,["modelValue"])):s("",!0),"PosText"==c.showType&&l.recoData.text?(t(),i("div",xe,[null!=l.recoData.detail?(t(),i(x,{key:0,ref:"posText",imageBG:c.imageBG,recoItem:l.recoData,contenteditable:c.PosTextEditable,onOnExitFullScreen:n[2]||(n[2]=e=>g.closePoxtextViewer()),fullScreen:c.showViewer},null,8,["imageBG","recoItem","contenteditable","fullScreen"])):s("",!0)])):s("",!0),"TableText"==c.showType&&l.recoData.text?(t(),i(w,{key:3,data:l.recoData.detail,height:"tableH",border:"",class:"recText recTextTable","row-class-name":g.getRowClass},{default:ue((()=>[a(v,{sortable:"",prop:"score",label:"置信度",width:"180"}),a(v,{prop:"text",label:"文本"})])),_:1},8,["data","row-class-name"])):s("",!0),h(a("div",null,[a("div",ve,[a(C,{tips:"带位置信息的文体",selected:"PosText"==c.showType,iconClass:"iconfont icon-postext",onClick:n[3]||(n[3]=e=>g.setShowType("PosText"))},null,8,["selected"]),a(C,{tips:"纯文本方式显示",selected:"PureText"==c.showType,iconClass:"el-icon-document",onClick:n[4]||(n[4]=e=>g.setShowType("PureText"))},null,8,["selected"]),a(C,{tips:"以表格方式显示",selected:"TableText"==c.showType,iconClass:"iconfont icon-table",onClick:n[5]||(n[5]=e=>g.setShowType("TableText"))},null,8,["selected"])]),"PosText"==c.showType?(t(),i(C,{key:0,tips:"放大显示",iconClass:"iconfont icon-fullscreen",onClick:g.showPoxtextViewer},null,8,["onClick"])):s("",!0),"PureText"==c.showType&&l.recoData.textEdited?(t(),i(C,{key:1,tips:"复制当前文本",iconClass:"el-icon-document-copy",onClick:g.onTextCopy},null,8,["onClick"])):s("",!0),"PosText"==c.showType?(t(),i("div",we,[a(C,{selected:c.PosTextEditable,tips:"开启/关闭编辑模式",iconClass:"iconfont icon-edit",onClick:n[6]||(n[6]=e=>c.PosTextEditable=!c.PosTextEditable)},null,8,["selected"]),a(C,{tips:"导出为PDF",iconClass:"iconfont icon-pdf",onClick:g.openPdfDialog},null,8,["onClick"]),a(C,{selected:c.imageBG,tips:"在文本底下显示图像",iconClass:"iconfont icon-imgtxt",onClick:n[7]||(n[7]=()=>{c.imageBG=!c.imageBG})},null,8,["selected"])])):s("",!0),"PureText"==c.showType&&l.recoData.textEdited!=l.recoData.text?(t(),i(C,{key:3,tips:"撤销文本修改",iconClass:"iconfont icon-revert",onClick:n[8]||(n[8]=e=>l.recoData.textEdited=l.recoData.text)})):s("",!0)],512),[[m,l.recoData.text]])],2),[[m,!g.isScaning()]]),c.AntOcrInited?(t(),i(I,{key:0,dialogVisible:c.saveToPdfVisible,"onUpdate:dialogVisible":n[9]||(n[9]=e=>c.saveToPdfVisible=e),recoItem:l.recoData},null,8,["dialogVisible","recoItem"])):s("",!0)],64)}));me.render=Ce,me.__scopeId="data-v-1df7ae6a";let Ie="";var Te=null;const ye={data:()=>({showViewer:!1,isDrawBox:!1,viewUrl:"",recThres:.6,keepLowScore:!1}),created:function(){Te=this,_.addMonitor("recThres",(e=>{Te.recThres=e,Te.drawImage()})),_.addMonitor("keepLowScore",(e=>{Te.keepLowScore=e,Te.drawImage()}))},components:{IconButton:b},props:["loading","recItem"],methods:{isScaning:()=>Te.recItem&&Te.recItem.isScaning,setViewer(e){Ie=document.body.style.overflow,document.body.style.overflow="hidden",this.isDrawBox?this.viewUrl=this.$refs.mainCanvas.toDataURL("image/png"):this.viewUrl=this.recItem.url,this.showViewer=e},closeViewer(){document.body.style.overflow=Ie,this.showViewer=!1},drawImage(){if(Te.img&&Te.imgCtx){var e=Te.$refs.mainCanvas,t=Te.img,i=Te.imgCtx;if(e.width=t.width,e.height=t.height,i.drawImage(t,0,0),Te.recItem.detail&&Te.isDrawBox){i.lineWidth=2;for(const e of Te.recItem.detail)if(!(e.score<Te.recThres)||Te.keepLowScore){var a=e.rect;i.beginPath(),i.moveTo(a[0].x,a[0].y),i.lineTo(a[1].x,a[1].y),i.lineTo(a[2].x,a[2].y),i.lineTo(a[3].x,a[3].y),i.lineTo(a[0].x,a[0].y),i.closePath(),i.strokeStyle=e.score<Te.recThres?"#ff0000":"#00ff00",i.stroke()}}}}},watch:{recItem:{deep:!0,handler:function(e,t){if(e){var i=this.$refs.mainCanvas;Te.lasturl!=e.url&&(Te.lasturl=e.url,Te.imgCtx=i.getContext("2d"),Te.img=new Image,Te.img.onload=function(){Te.drawImage()},Te.img.src=e.url,console.log("drawImage"))}}}}},ke=o("data-v-986383ee");n("data-v-986383ee");const be={class:"boxTextImage"},Se={ref:"mainCanvas",class:"ImagePreview"},De={key:0,class:"ImagePreview placeholder"},_e=a("div",{style:{"text-align":"left"}},[a("p",null,"拖动图像文件到此处")],-1),Le={style:{"text-align":"left"}};l();const Be=ke(((o,n,l,r,c,d)=>{const g=e("el-image-viewer"),u=e("IconButton");return t(),i("div",be,[h(a("div",{class:["ImagePreviewDiv",{scanBox:d.isScaning()}]},[a("canvas",Se,null,512)],2),[[m,l.recItem.url]]),l.recItem.url?s("",!0):(t(),i("div",De,[_e])),c.showViewer?(t(),i(g,{key:1,onClose:d.closeViewer,"url-list":[c.viewUrl]},null,8,["onClose","url-list"])):s("",!0),h(a("div",Le,[a(u,{tips:"大图预览",iconClass:"iconfont icon-fullscreen",onClick:n[1]||(n[1]=e=>d.setViewer(!0))}),a(u,{tips:"显示文本位置",iconClass:"iconfont icon-lineBox",selected:c.isDrawBox,onClick:n[2]||(n[2]=e=>{c.isDrawBox=!c.isDrawBox,d.drawImage()})},null,8,["selected"])],512),[[m,l.recItem.url]])])}));ye.render=Be,ye.__scopeId="data-v-986383ee";let Ee=null;const Pe={components:{ImageList:F,TextBox:me,ImageBox:ye},data:()=>({wasmloading:!0,dialogVisible:!1,recoData:{},uploadHover:0,mainRowHeight:"380",clientHeight:0}),mounted:function(){Ee=this;let e=document.getElementById("drop_area"),t=document.getElementById("drop_mask");t.addEventListener("drop",this.enentDrop,!1);var i=function(e){e.stopPropagation(),e.preventDefault(),Ee.uploadHover-=1},a=function(e){e.stopPropagation(),e.preventDefault(),Ee.uploadHover+=1},o=function(e){e.stopPropagation(),e.preventDefault()};t.addEventListener("dragleave",i),e.addEventListener("dragleave",i),t.addEventListener("dragenter",a),e.addEventListener("dragenter",a),e.addEventListener("dragover",o),t.addEventListener("dragover",o),Ee.clientHeight=document.documentElement.clientHeight,window.onresize=()=>{Ee.clientHeight=document.documentElement.clientHeight},Ee.calcMainRowHeight()},methods:{enentDrop(e){this.uploadHover=!1,e.stopPropagation(),e.preventDefault();let t=e.dataTransfer.files;Ee.$refs.ImageList.addImgPreview(t)},calcMainRowHeight(){let e=.6*Ee.clientHeight;e=Math.max(e,380),this.mainRowHeight=e.toString()},onRuntimeInitialized(){this.wasmloading=!1},onCurrentItemChange(e){this.recoData=e},clearRecognitionImage(){this.recoData={}}},watch:{clientHeight(e){this.timer||(this.timer=!0,setTimeout((function(){Ee.calcMainRowHeight(),this.timer=!1}),400))}}},Ve=o("data-v-46c39cea");n("data-v-46c39cea");const Re={id:"drop_area",style:{position:"relative"},"element-loading-text":"正在加载识别程序","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.8)"},He={id:"drop_mask",class:"drop_mask"},We=a("div",{class:"drop_mask-spinner"},[a("i",{class:"el-icon-upload2 drop_mask-icon"}),a("p",{class:"drop_mask-text"},"文件拖放到此处进行识别")],-1);l();const Me=Ve(((o,n,l,s,r,c)=>{const d=e("ImageBox"),g=e("el-col"),u=e("TextBox"),f=e("el-row"),x=e("ImageList"),v=p("loading");return h((t(),i("div",Re,[a(f,{type:"flex",justify:"center",ref:"mainRow",style:"height:"+r.mainRowHeight+"px"},{default:Ve((()=>[a(g,{class:"rightAlign",span:12},{default:Ve((()=>[a(d,{recItem:r.recoData,style:{height:"100%"}},null,8,["recItem"])])),_:1}),a(g,{class:"leftAlign",span:12},{default:Ve((()=>[a(u,{recoData:r.recoData},null,8,["recoData"])])),_:1})])),_:1},8,["style"]),a(x,{ref:"ImageList",onCurrentItemChange:c.onCurrentItemChange,onOnRuntimeInitialized:c.onRuntimeInitialized,onClearRecognitionImage:c.clearRecognitionImage},null,8,["onCurrentItemChange","onOnRuntimeInitialized","onClearRecognitionImage"]),h(a("div",He,[We],512),[[m,r.uploadHover]])],512)),[[v,r.wasmloading]])}));Pe.render=Me,Pe.__scopeId="data-v-46c39cea";var $e={data:()=>({imgUrl:"/assets/logo.e36a46b4.png",activeIndex:"0"}),methods:{handleSelect(){}}};const Oe=o("data-v-2ff12a7a");n("data-v-2ff12a7a");const Ue={class:"navbar"},ze={class:"home-link"},Ae={ref:"siteName",class:"site-name"},Fe=x('<div class="links" data-v-2ff12a7a><nav class="nav-links can-hide" data-v-2ff12a7a><div class="nav-item" data-v-2ff12a7a><a href="https://doc.pearocr.com" class="nav-link" target="_blank" data-v-2ff12a7a> 使用文档 </a></div><div class="nav-item" data-v-2ff12a7a><a href="https://github.com/PearOCR/pearocr_issue/issues" class="nav-link" target="_blank" data-v-2ff12a7a> 反馈意见 </a></div></nav></div>',1);l();const Ge=Oe(((e,o,n,l,s,r)=>(t(),i("div",Ue,[a("div",ze,[a("img",{class:"logo",src:s.imgUrl},null,8,["src"]),a("span",Ae,"PearOCR文字识别",512)]),Fe]))));$e.render=Ge,$e.__scopeId="data-v-2ff12a7a";const Ne={name:"Highlights",data:()=>({HighPoints:[{id:1,icon:"icon-free",title:"免费",content:"完全免费，没有任何次数限制，可以无限次使用"},{id:2,icon:"icon-safe",title:"安全",content:"全部数据本地运算，所有图片均不会被上传"},{id:3,icon:"icon-AI",title:"智能",content:"基于深度学习训练得到的模型，拥有强大的识别能力"},{id:4,icon:"icon-smile",title:"易用",content:"支持本地图片，或者直接读取剪切板而不需要先把图片存为文件"}]})},je=o("data-v-02272af8");n("data-v-02272af8");const Je={class:"HighlightsDiv rowCard"},qe={class:"marginSize"},Ke={class:"marginSize"};l();const Qe=je(((o,n,l,s,r,c)=>{const h=e("el-main");return t(),i(h,{class:"el-main_add"},{default:je((()=>[a("div",Je,[(t(!0),i(d,null,g(r.HighPoints,(e=>(t(),i("div",{class:"ShowItem",key:e.id},[a("i",{class:["iconfont iconshow",e.icon]},null,2),a("h2",qe,u(e.title),1),a("p",Ke,u(e.content),1)])))),128))])])),_:1})}));Ne.render=Qe,Ne.__scopeId="data-v-02272af8";const Xe={},Ye=o("data-v-11605ae5");n("data-v-11605ae5");const Ze=a("div",{class:"footerSlogans"},"END",-1);l();const et=Ye(((o,n)=>{const l=e("el-divider"),s=e("el-footer");return t(),i(s,null,{default:Ye((()=>[a(l,{class:".el-divider_"}),Ze])),_:1})}));Xe.render=et,Xe.__scopeId="data-v-11605ae5";var tt=v({name:"App",components:{RecoMain:Pe,AntOcrHeader:$e,Highlights:Ne,Footer:Xe}});const it=o("data-v-f8ca77a2");n("data-v-f8ca77a2");const at={class:"wholeLimit"};l();const ot=it(((o,n,l,s,r,c)=>{const g=e("AntOcrHeader"),h=e("RecoMain"),m=e("el-main"),u=e("Highlights"),f=e("Footer"),p=e("el-container");return t(),i(d,null,[a(g),a("div",at,[a(p,{class:"wholeBox"},{default:it((()=>[a(m,null,{default:it((()=>[a(h)])),_:1}),a(u),a(f)])),_:1})])],64)}));tt.render=ot,tt.__scopeId="data-v-f8ca77a2";const nt=w(tt);nt.use(C),nt.mount("#app");export{O as e};
